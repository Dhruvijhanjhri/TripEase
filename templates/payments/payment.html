{% extends 'base.html' %}
{% load static %}

{% block title %}Payment - TripEase{% endblock %}

{% block content %}
<div class="container" style="padding: 40px 0;">
    <h2 class="section-title">Complete Payment</h2>
    
    <div class="card" style="padding: 20px; margin-bottom: 30px;">
        <h3>Booking Summary</h3>
        <div style="color: #475569; margin: 10px 0;">
            {{ booking.flight.airline }} - {{ booking.flight.flight_number }}<br>
            {{ booking.flight.source.code }} → {{ booking.flight.destination.code }}<br>
            {{ booking.number_of_passengers }} Passenger{{ booking.number_of_passengers|pluralize }}
        </div>
        <div style="font-size: 1.5rem; font-weight: 700; color: #1e5eff; margin-top: 15px;">
            Total Amount: ₹{{ booking.total_price|floatformat:0 }}
        </div>
    </div>
    
    <form method="post" class="auth-form" style="max-width: 500px; margin: 0 auto;">
        {% csrf_token %}
        
        <h3 style="margin-bottom: 20px;">Select Payment Method</h3>
        
        <div style="margin-bottom: 20px;">
            {{ form.payment_method }}
            {% if form.payment_method.errors %}
                <div class="error-message">{{ form.payment_method.errors }}</div>
            {% endif %}
        </div>
        
        <!-- UPI Fields -->
        <div id="upi_fields" style="display: none; margin-bottom: 20px;">
            <div class="form-group">
                <label for="{{ form.upi_id.id_for_label }}">UPI ID</label>
                {{ form.upi_id }}
                {% if form.upi_id.errors %}
                    <div class="error-message">{{ form.upi_id.errors }}</div>
                {% endif %}
            </div>
        </div>
        
        <!-- Card Fields -->
        <div id="card_fields" style="display: none; margin-bottom: 20px;">
            <div class="form-group">
                <label for="{{ form.card_number.id_for_label }}">Card Number</label>
                {{ form.card_number }}
            </div>
            <div class="form-group">
                <label for="{{ form.card_name.id_for_label }}">Cardholder Name</label>
                {{ form.card_name }}
            </div>
            <div class="form-row">
                <div class="form-group">
                    <label for="{{ form.card_expiry.id_for_label }}">Expiry (MM/YY)</label>
                    {{ form.card_expiry }}
                </div>
                <div class="form-group">
                    <label for="{{ form.card_cvv.id_for_label }}">CVV</label>
                    {{ form.card_cvv }}
                </div>
            </div>
        </div>
        
        <!-- Net Banking Fields -->
        <div id="netbanking_fields" style="display: none; margin-bottom: 20px;">
            <div class="form-group">
                <label for="{{ form.bank_name.id_for_label }}">Select Bank</label>
                {{ form.bank_name }}
            </div>
        </div>
        
        <button type="submit" class="btn btn-primary btn-full">Pay ₹{{ booking.total_price|floatformat:0 }}</button>
    </form>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const paymentMethod = document.querySelectorAll('input[name="payment_method"]');
    const upiFields = document.getElementById('upi_fields');
    const cardFields = document.getElementById('card_fields');
    const netbankingFields = document.getElementById('netbanking_fields');
    
    function toggleFields() {
        upiFields.style.display = 'none';
        cardFields.style.display = 'none';
        netbankingFields.style.display = 'none';
        
        const selected = document.querySelector('input[name="payment_method"]:checked');
        if (selected) {
            if (selected.value === 'upi') {
                upiFields.style.display = 'block';
            } else if (selected.value === 'card') {
                cardFields.style.display = 'block';
            } else if (selected.value === 'netbanking') {
                netbankingFields.style.display = 'block';
            }
        }
    }
    
    paymentMethod.forEach(radio => {
        radio.addEventListener('change', toggleFields);
    });
    
    toggleFields();
});
</script>
{% endblock %}






