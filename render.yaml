services:
  - type: web
    name: tripease
    env: python
    plan: free
    buildCommand: pip install -r requirements.txt
    # Ensure migrations run before the app starts (idempotent)
    startCommand: |
      python manage.py migrate --noinput
      python manage.py collectstatic --noinput
      gunicorn tripease.wsgi:application --bind 0.0.0.0:$PORT
    envVars:
      - key: DJANGO_SETTINGS_MODULE
        value: tripease.settings
      - key: SECRET_KEY
        value: "set-a-strong-secret-key"
      - key: DEBUG
        value: "False"
      - key: ALLOWED_HOSTS
        value: "tripease-y0yf.onrender.com,localhost,127.0.0.1"
      # Use your Supabase Postgres connection string here (not the anon key)
      - key: DATABASE_URL
        value: "set-your-supabase-postgres-connection-string"
      # Optional: if you prefer SUPABASE_DB_URL env name
      - key: SUPABASE_DB_URL
        value: "set-your-supabase-postgres-connection-string"
      - key: SUPABASE_URL
        value: "https://cakngwyybeqlxdolbdqh.supabase.co"
      - key: SUPABASE_ANON_KEY
        value: "set-your-supabase-anon-key"

